# 프로세스 - Thread

## 프로세스 
- 프로세스 각각 독립된 메모리를 할당받음
- 프로세스당 최소 1스레드를 가지고 있음
- 각 프로세스는 별토 주소에서 실행, 다른 프로세스의 변수나 자료구조 접근 X
![프로세스](./process.png)

### 주소 공간
- 할당해주는 메모리 공간은 4가지(Code, Data, Stack, Heap)가 있습니다.
    ![메모리](./memory.png)
    - Code 
    - Data
    - Stack
    - Heap

### PCB
- CPU의 스케쥴링 상태에 따라 CPU 점유, 진행 현황을 저장, 불러오기 위한 OS 자료 구조
- 프로세스 상태 : 생성(new), 준비(ready), 실행(running), 정지(halted), 종료(terminated)
- Program Counter(PC) : 프로세스가 다음에 실행할 명령어의 주소를 가리킴
- CPU 레지스터들 : 누산기, 색인 레지스터, 스택 레지스터, 범용 레지스터, 상태 코드 -> PC와 함께 인터럽프 발생 시 저장됨
- CPU 스케쥴링 정보 : 프로세스 우선순위, 스케쥴 큐에 대한 포인터와 다른 스케쥴 매개변수
- 메모리 관리 정보 : OS에 의해 사용되는 메모리 시스템
- accounting 정보 : CPU가 사용된 양과 실시간, 시간 제한, 계정 번호, job 또는 프로세스 번호
- I/O 상태 정보 : 프로세스에 할당된 I/O 장치들과 열린 파일의 리스트 등을 포함

### 가상 메모리

## 쓰레드
- 프로세스가 할당받은 자원을 이용하는 실행 흐름의 단위

- 1개 이상의 스레드를 가질 수 있으며 멀티 스레드라고 함

- 스레드는 프로세스 내에 Stack만 따로 할당 받고 Code, Data, Heap 영역을 공유함

- 메모리를 공유하여 시스템 자원 소모가 줄어들어 응답 시간이 단축

- 동기화 문제 -> 공유된 데이터 때문

- 디버깅이 어려움

- 스레드를 많이 생성하면 문맥 교환(Context Switch)이 많이 일어나 성능이 저하됨

![쓰레드](./thread.png)


## 멀티 프로세싱
- 다중 CPU 환경에서 여러 응용 프로그램을 병렬 처리하는 시스템
- 각 프로세스 간 메모리 구분이 필요하거나 독립된 주소 공간을 가져야 할 경우 사용
- 장점
    - 독립된 구조로 안정성이 높음
    - 프로세스 중에 하나에 문제가 생겨도 다른 프로세스에 영향을 주지 않음 -> 작업이 느려져도 멈추진 않음
    - 현대의 컴퓨터들은 대부분 멀티 코어 이상을 지원하여 멀티 프로세싱을 함
- 단점
    - 독립된 메모리 영역이다 보니 작업량이 늘어나면 문맥 교환도 늘어나 오버 헤드가 발생하여 성능 저하
    - 문맥 교환 과정에서 캐시 메모리 초기화 등 무거운 작업이 진행되고 시간이 소모하여 오버헤드가 발생

## 멀티 스레드
- 하나의 프로세스 내에서 둘 이상의 스레드가 동시에 작업을 수행하는 것을 의미

- 장점

    - 시스템 자원소모 감소 (자원의 효율성 증가)
    - 프로세스를 생성하고 자원을 할당하는 시스템 콜이 줄어 자원이 효율적으로 관리됨
    - 시스템 처리율 향상 (처리 비용 감소)
    - 스레드 간 데이터를 주고 받는 것이 간단해지기에 자원 소모가 줄어듬
    - 스레드 사이 작업량이 작아 문맥 교환이 빠름 (캐시 메모리를 비울 필요가 없음)
    - 간단한 통신 방법으로 프로그램 응답 시간 단축
    - 스레드는 프로세스 내 스택 영역을 제외한 메모리 영역을 공유하기에 통신 비용이 적음
    - 힙 영역을 공유하므로 데이터를 주고 받을 수 있음
    
- 단점

    - 자원을 공유하기에 동기화 문제가 발생함 (Bottleneck, deadlock)
    - 주의 깊은 설계가 필요하며 디버깅이 어려움
    - 단일 프로세스 시스템의 경우 효과를 기대하기 어려움